{"version":3,"file":"generated.js","sources":["node_modules/browserify/node_modules/browser-pack/_prelude.js","src/index.js","src/polyfill.js","src/tokenlist.js"],"names":["f","exports","module","define","amd","g","window","global","self","this","TokenList","e","t","n","r","s","o","u","a","require","i","Error","code","l","call","length",1,"polyfill","root","factory","tokenListForElementAttribute","element","attribute","getAttribute","bind","setAttribute","getClassList","getRelList","makeArgumentsIterator","callback","args","slice","arguments","forEach","arg","contains","context","document","link","createElement","hasClassList","hasRelList","Object","defineProperty","Element","prototype","get","svg","createElementNS","hasSvgClassList","SVGElement","HTMLAnchorElement","HTMLAreaElement","HTMLLinkElement","object","DOMTokenList","classList","add","remove","toggle","token","force","contained","replace","oldToken","newToken","index","item","tokens","splice","apply","verifyToken","asciiWhiteSpace","test","passthru","value","parse","text","trim","lookup","split","filter","serialize","join","removeFromArray","list","indexOf","read","write","supported","decode","encode","updateGetterProxy","getTokens","setTokens","stringify","toString","parseInt","isNaN","input","map","push","exists","_tokens","supports","Boolean","toLowerCase","TypeError","defineProperties","set","_iterator","Symbol","iterator","next","done","undefined","Proxy","numericPattern","target","property","registeredGetters","proxyItem","key","configurable"],"mappings":"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AE,OAAA,CACA,GAAAC,GAAA,OACA,OAAA,IAAAD,OAAApH,GACA8C,IAAA,SAAAwE,EAAAC,GACA,GAAA5C,GAAA2C,EAAAC,EACA,OAAAJ,UAAAxC,EACAA,EAGA0C,EAAA5C,KAAA8C,GAIAvH,EAAAmE,KAAAoD,IAAAJ,OAHAA,UAQA,GAAAK,GAAA,EACAC,EAAA,SAAAC,GACAhF,OAAAC,eAAA3C,EAAA0H,GACAC,cAAA,EACA7E,IAAA,WACA,MAAA9C,GAAAmE,KAAAuD,IAAAP,UAcA,OATAvB,GAAA,SAAA7E,GACA,KAAAA,GAAAyG,EAAAA,IACAC,EAAAD,IAIAxH,EAAAmE,KAAA,GAGAnE;AFhTA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACTA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC7JA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","sourcesContent":["(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})","\n// CommonJS because we're using this only to generate the bundle\n\nvar TokenList = require('./tokenlist');\nvar polyfill = require('./polyfill');\n\nTokenList.polyfill = polyfill;\n\nmodule.exports = TokenList;\n","(function (root, factory) {\n  'use strict';\n\n  if (typeof exports === 'object') {\n    // Node\n    module.exports = factory(require('./tokenlist'), root);\n  } else if (typeof define === 'function' && define.amd) {\n    // AMD. Register as an anonymous module.\n    define(['./tokenlist'], function(TokenList) {\n      return factory(TokenList, root);\n    });\n  } else {\n    // Browser globals\n    factory(root.TokenList, root);\n  }\n}(this, function(TokenList, root) {\n\n  function tokenListForElementAttribute(element, attribute) {\n    return TokenList(\n      element.getAttribute.bind(element, attribute),\n      element.setAttribute.bind(element, attribute)\n    );\n  }\n\n  function getClassList() {\n    return tokenListForElementAttribute(this, 'class');\n  }\n\n  function getRelList() {\n    return tokenListForElementAttribute(this, 'rel');\n  }\n\n  function makeArgumentsIterator(callback) {\n    return function() {\n      var args = [].slice.call(arguments, 0);\n\n      // make sure all arguments are syntactically correct\n      args.forEach(function(arg) {\n        this.contains(arg);\n      }, this);\n\n      // only then apply the callback to every argument\n      args.forEach(function(arg) {\n        callback.call(this, arg);\n      }, this);\n    };\n  }\n\n  function polyfill(context) {\n    if (!context || !context.document) {\n      return;\n    }\n\n    var link = context.document.createElement('a');\n    var hasClassList = 'classList' in link;\n    var hasRelList = 'relList' in link;\n\n    if (!hasClassList) {\n      // https://github.com/jwilsson/domtokenlist/blob/master/src/classList.js\n      Object.defineProperty(Element.prototype, 'classList', {\n        get: getClassList,\n      });\n    }\n\n    var svg = context.document.createElementNS('http://www.w3.org/2000/svg', 'svg');\n    var hasSvgClassList = 'classList' in svg;\n    if (!hasSvgClassList) {\n      // https://developer.microsoft.com/en-us/microsoft-edge/platform/issues/1173756/\n      Object.defineProperty(SVGElement.prototype, 'classList', {\n        get: getClassList,\n      });\n    }\n\n    // https://github.com/jwilsson/domtokenlist/blob/master/src/relList.js\n    if (!hasRelList) {\n      [context.HTMLAnchorElement, context.HTMLAreaElement, context.HTMLLinkElement].forEach(function(object) {\n        Object.defineProperty(object.prototype, 'relList', {\n          get: getRelList,\n        });\n      });\n    }\n\n    if (!hasClassList) {\n      // we're already returning TokenList, so there's no need to patch DOMTokenList\n      return;\n    }\n\n    var prototype = context.DOMTokenList.prototype;\n\n    // Older versions of the HTMLElement.classList spec didn't allow multiple arguments\n    // https://github.com/jwilsson/domtokenlist/blob/master/src/DOMTokenList-newest.js\n    // https://connect.microsoft.com/IE/Feedback/Details/920755/\n    link.classList.add('a', 'b');\n    if (!link.classList.contains('b')) {\n      prototype.add = makeArgumentsIterator(prototype.add);\n      prototype.remove = makeArgumentsIterator(prototype.remove);\n    }\n\n    // Older versions of the spec didn't know the force argument\n    // https://github.com/jwilsson/domtokenlist/blob/master/src/DOMTokenList-newest.js\n    // https://connect.microsoft.com/IE/Feedback/details/878564/\n    if (!link.classList.toggle('a', true)) {\n      prototype.toggle = function (token, force) {\n        var contained = this.contains(token);\n        if (force === false || contained && force !== true) {\n          this.remove(token);\n          return false;\n        }\n\n        this.add(token);\n        return true;\n      };\n    }\n\n    // Older versions of the spec didn't know the replace() method\n    // https://bugs.chromium.org/p/chromium/issues/detail?id=580339\n    // https://bugzilla.mozilla.org/show_bug.cgi?id=1224186\n    if (!link.classList.replace) {\n      prototype.replace = function(oldToken, newToken) {\n        // verfiy token integrity before changing anything\n        var contained = this.contains(oldToken);\n        this.contains(newToken);\n\n        if (!contained) {\n          return;\n        }\n\n        // find first occurrence of oldToken so we know\n        // where to inject newToken later\n        var index = 0;\n        while (this.item(index) !== oldToken) {\n          index++;\n        }\n\n        // remove all occurrences of oldToken, there may be multiple\n        this.remove(oldToken);\n        // inject the newToken at the previously identified position\n        var tokens = [].slice.call(this, 0, this.length);\n        tokens.splice(index, 0, newToken);\n        // since we can't reset the internal array,\n        // removing and setting all tokens will have to do\n        this.remove.apply(this, tokens);\n        this.add.apply(this, tokens);\n      };\n    }\n\n    // NOTE: can't polyfill the value property, as we don't have\n    // a reference to the original element in order to set the\n    // attribute's value verbatim, as required by the spec\n  }\n\n  // patch the current context (window)\n  polyfill(root);\n\n  // in case we need to apply this to an iframe\n  return polyfill;\n}));\n","/*\n  Implements the DOMTokenList interface\n    https://dom.spec.whatwg.org/#interface-domtokenlist\n\n  Inspired by\n    https://github.com/bkardell/tokenListFor/blob/master/_tokenListFor.js\n    https://github.com/jwilsson/domtokenlist/blob/master/src/DOMTokenList.js\n*/\n(function (root, factory) {\n  'use strict';\n\n  if (typeof exports === 'object') {\n    // Node\n    module.exports = factory();\n  } else if (typeof define === 'function' && define.amd) {\n    // AMD. Register as an anonymous module.\n    define([], factory);\n  } else {\n    root.TokenList = factory();\n  }\n}(this, function() {\n  'use strict';\n  /*global Symbol, Proxy */\n\n  // https://encoding.spec.whatwg.org/#ascii-whitespace\n  // TAB, VT, FF, CR, Space\n  var asciiWhiteSpace = /[\\u0009\\u000A\\u000C\\u000D\\u0020]+/;\n\n  function verifyToken(token) {\n    // NOTE: throwing Error instead of DOMException because the latter\n    // doesn't work properly across browsers, let alone Node.\n\n    if (token === '') {\n      // https://heycam.github.io/webidl/#syntaxerror\n      // throw new DOMException('Token must not be the empty string', 'SyntaxError', 12);\n      throw new Error('Token must not be the empty string');\n    }\n\n    if (asciiWhiteSpace.test(token)) {\n      // https://heycam.github.io/webidl/#invalidcharactererror\n      // throw new _DOMException('Token must not contain ASCII whitespace', 'InvalidCharacterError', 5);\n      throw new Error('Token must not contain ASCII whitespace');\n    }\n  }\n\n  function passthru(value) {\n    return value;\n  }\n\n  // https://dom.spec.whatwg.org/#concept-ordered-set-parser\n  function parse(text) {\n    text = text && text.trim() || '';\n    if (!text) {\n      return [];\n    }\n\n    var lookup = {};\n    return text.split(asciiWhiteSpace).filter(function(token) {\n      if (lookup[token]) {\n        return false;\n      }\n\n      lookup[token] = true;\n      return true;\n    });\n  }\n\n  // https://dom.spec.whatwg.org/#concept-ordered-set-serializer\n  function serialize(tokens) {\n    return tokens.join(' ');\n  }\n\n  function removeFromArray(list, item) {\n    var index = list.indexOf(item);\n    if (index !== -1) {\n      list.splice(index, 1);\n    }\n  }\n\n  return function(read, write, supported, decode, encode) {\n\n    // noop in case we're able to use Proxy,\n    // overwritten at the end of the file if not.\n    var updateGetterProxy = function(){};\n\n    var getTokens = function() {\n      var tokens = parse(read());\n      updateGetterProxy(tokens.length);\n      return tokens;\n    };\n\n    var setTokens = function(tokens) {\n      write(serialize(tokens));\n    };\n\n    var stringify = function() {\n      // currently specifed as `return read()` but about to change back\n      // see https://github.com/whatwg/dom/issues/105\n      return serialize(getTokens());\n    };\n\n    if (!decode) {\n      decode = passthru;\n    }\n\n    if (!encode) {\n      encode = passthru;\n    }\n\n    var TokenList = {\n      // https://dom.spec.whatwg.org/#dom-domtokenlist-stringifier\n      toString: stringify,\n\n      // https://dom.spec.whatwg.org/#dom-domtokenlist-item\n      item: function(index) {\n        // NOTE: unspecified behavior, but implemented in Gecko and Blink\n        index = parseInt(index);\n        if (isNaN(index)) {\n          index = 0;\n        }\n\n        return decode(getTokens()[index] || null);\n      },\n\n      // https://dom.spec.whatwg.org/#dom-domtokenlist-contains\n      contains: function(token) {\n        // NOTE: unspecified behavior, but implemented in Gecko and Blink\n        verifyToken(token);\n\n        return getTokens().indexOf(encode(token)) !== -1;\n      },\n\n      // https://dom.spec.whatwg.org/#dom-domtokenlist-add\n      add: function() {\n        var input = [].map.call(arguments, encode);\n        input.forEach(verifyToken);\n\n        var tokens = getTokens();\n        var length = tokens.length;\n\n        input.forEach(function(token) {\n          if (tokens.indexOf(token) === -1) {\n            tokens.push(token);\n          }\n        });\n\n        if (tokens.length !== length) {\n          setTokens(tokens);\n        }\n      },\n\n      // https://dom.spec.whatwg.org/#dom-domtokenlist-remove\n      remove: function() {\n        var input = [].map.call(arguments, encode);\n        input.forEach(verifyToken);\n\n        var tokens = getTokens();\n        var length = tokens.length;\n        input.forEach(function(token) {\n          removeFromArray(tokens, token);\n        });\n\n        if (tokens.length !== length) {\n          setTokens(tokens);\n        }\n      },\n\n      // https://dom.spec.whatwg.org/#dom-domtokenlist-toggle\n      toggle: function(token, force) {\n        token = encode(token);\n        verifyToken(token);\n\n        var tokens = getTokens();\n        var exists = tokens.indexOf(token) !== -1;\n\n        if (exists) {\n          if (!force) {\n            removeFromArray(tokens, token);\n            setTokens(tokens);\n            return false;\n          }\n\n          // forced add of existing token\n          return true;\n        }\n\n        if (force === false) {\n          // forced removal of non-existing token\n          return false;\n        }\n\n        // add of non-existing token\n        tokens.push(token);\n        setTokens(tokens);\n        return true;\n      },\n\n      // https://dom.spec.whatwg.org/#dom-domtokenlist-replace\n      // Note: will collapse duplicates, i.e. replace(\"a\", \"x\")\n      // will turn \"c a b a a d\" into \"c x b d\",\n      replace: function(oldToken, newToken) {\n        oldToken = encode(oldToken);\n        newToken = encode(newToken);\n\n        verifyToken(oldToken);\n        verifyToken(newToken);\n\n        var tokens = getTokens();\n        var index = tokens.indexOf(oldToken);\n\n        if (index === -1) {\n          return;\n        }\n\n        tokens[index] = newToken;\n        var _tokens = tokens.filter(function(token) {\n          return token !== oldToken;\n        });\n\n        setTokens(_tokens);\n      },\n\n      // https://dom.spec.whatwg.org/#dom-domtokenlist-supports\n      // https://developer.mozilla.org/en-US/docs/Web/API/DOMTokenList/supports\n      supports: function(token) {\n        token = encode(token);\n\n        if (supported) {\n          return Boolean(supported(token.toLowerCase()));\n        }\n\n        throw new TypeError('No supported tokens defined');\n      },\n    };\n\n    Object.defineProperties(TokenList, {\n      // https://dom.spec.whatwg.org/#dom-domtokenlist-length\n      length: {\n        get: function() {\n          return getTokens().length;\n        },\n      },\n\n      // https://dom.spec.whatwg.org/#dom-domtokenlist-value\n      value: {\n        get: stringify,\n        set: function(value) {\n          setTokens(parse(value));\n        },\n      },\n    });\n\n    // iterable<DOMString> https://dom.spec.whatwg.org/#interface-domtokenlist\n    var _iterator = typeof Symbol !== 'undefined' ? Symbol.iterator : '@@iterator';\n    TokenList[_iterator] = function() {\n      var tokens = getTokens();\n      var index = 0;\n\n      // https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Iteration_protocols\n      return {\n        next: function() {\n          return index < tokens.length\n            ? { value: tokens[index++], done: false }\n            : { value: undefined, done: true };\n        },\n      };\n    };\n\n    if (typeof Proxy !== 'undefined') {\n      var numericPattern = /^\\d+$/;\n      return new Proxy(TokenList, {\n        get: function(target, property) {\n          var value = target[property];\n          if (value !== undefined) {\n            return value;\n          }\n\n          if (!numericPattern.test(property)) {\n            return undefined;\n          }\n\n          return TokenList.item(property) || undefined;\n        },\n      });\n    } else {\n      // https://github.com/Alhadis/DOMTokenList/blob/v1.0.0/src/token-list.js#L69-L81\n      var registeredGetters = 0;\n      var proxyItem = function(key) {\n        Object.defineProperty(TokenList, key, {\n          configurable: false,\n          get: function() {\n            return TokenList.item(key) || undefined;\n          },\n        });\n      };\n\n      updateGetterProxy = function(length) {\n        for (; registeredGetters <= length; registeredGetters++) {\n          proxyItem(registeredGetters);\n        }\n      };\n\n      TokenList.item(0);\n    }\n\n    return TokenList;\n  };\n}));\n"]}